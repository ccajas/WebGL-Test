/*! WebGL_test - ver. 0.1.0 */
Vue.config.debug=!1,Vue.component("viewport",{data:function(){return{componentTypes:this.$parent.componentTypes,systems:this.$parent.systems}},compiled:function(){console.log("Viewport loaded");var a=this.$el,b=[];new SystemManager(b);b.length<1&&console.log("No component lists found!");new App(a)},template:'<canvas id="draw"></canvas>'}),Vue.component("editable",{props:["textContent"],data:function(){return{textModified:"",viewable:!1}},methods:{keyEdit:function(a){this.textModified=a.target.innerText,9==a.keyCode&&(document.execCommand("styleWithCSS",!1,null),document.execCommand("indent",!0,null),a.preventDefault())},save:function(){this.textModified.trim()&&this.$dispatch("saveCode",this.textModified)}},watch:{textContent:function(){this.textModified=this.textContent,this.viewable=""!=this.textContent,Prism.highlightAll()}}}),Vue.component("listitem",{props:{level:Number,index:Number,item:{type:Object},icon:String,src:Array},template:"#listitem-template",data:function(){return{open:!0,selected:!1}},computed:{hasData:function(){var a=this.item.data&&this.item.data.length>0;return this.icon=a||this.level<2?this.icon:"&#xf0ab;",a}},events:{removeDataItem:function(a){console.log("remove item",a),this.item.data.splice(a,1)}},methods:{addSub:function(){this.item.data=this.item.data||[],this.item.data.push({name:"NewItem",meta:"type",data:[]}),this.$dispatch("saveStorage")},remove:function(){this.$dispatch("removeDataItem",this.index),this.$dispatch("saveStorage")}}}),Vue.component("item",{props:{value:String,meta:Boolean,idx:Number,src:{type:Array}},template:"#item-editable",data:function(){return{selected:!1}},computed:{hasSrc:function(){return this.src&&this.src.length>0}},methods:{select:function(){this.selected=!0,this.hasSrc||(this.$els.field.style.display="inline",this.$els.field.focus())},deselect:function(){this.selected=!1,console.log("deselect"),this.hasSrc||(this.$els.field.style.display="none")},update:function(){this.selected=!1,this.$els.field.style.display="none",console.log("updated item "+this.idx,this.value)}}});var vm=new Vue({el:"#app",data:{newItem:"",component_data:null,system_data:null,editorText:"Add your text here!",currIndex:-1,componentTypes:[],systems:[],section:"",sections:[{name:"Component",icon:"&#xf01c;",color:"#fb0"},{name:"System",icon:"&#xf04e;",color:"#bf7"},{name:"EntityTemplate",icon:"&#xf020;",color:"#7ff"},{name:"ScreenElement",icon:"&#xf11e;",color:"#0bf"}],sectionData:{name:"",meta:"",data:[]}},compiled:function(){var a=this;this.section=this.sections[0],this.component_data=JSON.parse(localStorage.getItem("component_data"))||{name:"Components",data:[]},this.system_data=JSON.parse(localStorage.getItem("system_data"))||{name:"Systems",data:[]},this.sectionData=this[this.section.name.toLowerCase()+"_data"],this.sections[0].src=[],this.sections[1].src=this.component_data.data,console.log("sections",this.sections),this.component_data.data.forEach(function(b){a.componentTypes.push(new ComponentType(b.name))}),console.log("componentTypes",this.componentTypes)},events:{saveStorage:function(){var a=this.section.name.toLowerCase()+"_data";localStorage.setItem(a,JSON.stringify(this.sectionData))}},methods:{setView:function(a){a.text!=this.section.name&&(this.editorText=""),this.section=a,this.sectionData=this[a.name.toLowerCase()+"_data"]},addItem:function(){var a=this.newItem.trim();if(a){var b=this.sectionData.length+1;this.sectionData.data.push({name:a,type:b,data:[]}),this.newItem="",this.$emit("saveStorage")}}}});