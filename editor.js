/*! WebGL_test - ver. 0.1.0 */
Vue.config.debug=!1,Vue.component("viewport",{data:function(){return{componentTypes:this.$parent.componentTypes,systems:this.$parent.systems}},compiled:function(){console.log("Viewport loaded");var a=this.$el,b=[];new SystemManager(b);b.length<1&&console.log("No component lists found!");new App(a)},template:'<canvas id="draw"><div>{{ e_noGL }}</div></canvas>'}),Vue.component("editable",{props:["textContent"],data:function(){return{textModified:"",viewable:!1}},methods:{keyEdit:function(a){this.textModified=a.target.innerText,9==a.keyCode&&(document.execCommand("styleWithCSS",!1,null),document.execCommand("indent",!0,null),a.preventDefault())},save:function(){this.textModified.trim()&&this.$dispatch("saveCode",this.textModified)}},watch:{textContent:function(){this.textModified=this.textContent,this.viewable=""!=this.textContent,Prism.highlightAll()}}}),Vue.component("detailview",{methods:{clicked:function(){console.log("clicked!")}}}),Vue.component("listitem",{props:["key","item","section"],methods:{viewDetail:function(){this.key||this.item.name;console.log("clicked on item",this.key||this.item.name,this.item)}}});var vm=new Vue({el:"#app",data:{newItem:"",component_data:null,system_data:null,editorText:"Add your text here!",currIndex:-1,componentTypes:[],systems:[],section:"",sections:[{text:"Component",icon:"&#xf01c;",color:"#fb0"},{text:"System",icon:"&#xf04e;",color:"#bf7"},{text:"EntityTemplate",icon:"&#xf020;",color:"#7ff"},{text:"ScreenElement",icon:"&#xf11e;",color:"#0bf"}],tl_data:{},section_data:null},compiled:function(){var a=this;this.section=this.sections[0],this.component_data=JSON.parse(localStorage.getItem("component_data"))||[],this.system_data=JSON.parse(localStorage.getItem("system_data"))||[],this.section_data=this[this.section.text.toLowerCase()+"_data"],console.log(this.section_data),this.component_data.forEach(function(b){a.componentTypes.push(new ComponentType(b.text,b.type))})},events:{saveCode:function(a){var b;try{b=JSON.parse(a)}catch(c){return console.error("Invalid JSON data:",c),!1}console.log("saving code to index "+this.currIndex,b),console.log(this.section_data[this.currIndex]),this.section_data[this.currIndex]=b,this.saveStorage(this.section_data)}},methods:{setView:function(a){a.text!=this.section.text&&(this.editorText=""),this.section=a,this.section_data=this[a.text.toLowerCase()+"_data"]},addItem:function(){var a=this.newItem.trim();if(a){var b=this.section_data.length+1;this.section_data.push({name:a,type:b,data:{}}),this.newItem="",this.saveStorage(this.section_data)}},removeItem:function(a){this.section_data.splice(a,1),this.saveStorage(this.section_data)},addSubItem:function(a){var b=this.newItem.trim();if(b){var c=this.section_data[a],d=c.type;console.log(c.data),c.data[b]={},c.data[b].type="type",this.section_data.splice(a,1),this.section_data.push({name:c.name,type:d,data:c.data}),this.newItem="",this.saveStorage(this.section_data)}},viewCode:function(a){var b=JSON.stringify(this.section_data[a],null,4);this.editorText=b,this.currIndex=a;var c=this.section_data[a],d=this;this.tl_data={},Object.keys(c).forEach(function(a){"object"!=typeof c[a]&&(d.tl_data[a]=c[a])})},saveStorage:function(a){var b=this.section.text.toLowerCase()+"_data";localStorage.setItem(b,JSON.stringify(a))}}});